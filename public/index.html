<!DOCTYPE html>
<html lang="en" dir="ltr" ng-app="shoppingCart">
  <head>
    <meta charset="utf-8">
    <title>The Cat Emporium</title>
    <!-- ======================
    | | SCRIPTS
    ======================= -->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.7.8/angular.min.js" charset="utf-8"></script>
    <script src="/js/app.js" charset="utf-8"></script>
    <!-- ======================
    | | STYLESHEETS
    ======================= -->
    <link rel="stylesheet" href="css/main.css">
  </head>
  <body ng-controller="MainController as ctrl">
  <div class="wrapper">
    <!-- ======================
    | | HEADER
    ======================= -->
    <header>
      <h1>The Cat Emporium</h1>
    </header>
    <!-- ======================
    | | MAIN
    ======================= -->
    <main>
      <!-- ===== NAVIGATION ===== -->
      <nav>
        <ul class="displayInline">
          <li ng-if="!ctrl.loggedInUser"
              ng-click="ctrl.showNewForm = !ctrl.showNewForm; ctrl.showLogInForm = false"><a href="#">Sign Up</a></li>
          <li ng-if="!ctrl.loggedInUser"
              ng-click="ctrl.showLogInForm = !ctrl.showLogInForm; ctrl.showNewForm = false"><a href="#">Log In</a></li>
          <li ng-if="ctrl.loggedInUser">
            <a href="#">Cart</a>
          </li>
          <li ng-if="ctrl.loggedInUser"
              ng-click="ctrl.logOut()"><a href="#">Log Out</a></li>
        </ul>
      </nav>
      <div ng-if="ctrl.showNewForm">
        <h3>Sign Up</h3>
        <form ng-submit="ctrl.createUser()">
          Username: <input type="text" ng-model="ctrl.createdUsername" />
          Password: <input type="password" ng-model="ctrl.createdPassword" />
          <input type="submit" value="Create"/>
        </form>
      </div>
      <div ng-if="ctrl.showLogInForm">
        <h3>Log In</h3>
        <form ng-submit="ctrl.logIn()">
          Username: <input type="text" ng-model="ctrl.username" />
          Password: <input type="password" ng-model="ctrl.password" />
          <input type="submit" value="Log In" />
        </form>
      </div>
      <div ng-if="ctrl.userIsAdmin">
        <form ng-submit="ctrl.addItem()">
          <fieldset>
            <legend>Add an Item</legend>
              <input type="text" placeholder="name" ng-model="ctrl.name" />
              <input type="text" placeholder="description" ng-model="ctrl.description" />
              <input type="text" placeholder="image link" ng-model="ctrl.image" />
              <input type="number" placeholder="cost" ng-model="ctrl.cost" />
              <input type="number" placeholder="stockQuantity" ng-model="ctrl.stockQuantity" />
              <br>
              <input type="submit" value="add item" />
          </fieldset>
        </form>
      </div>
      <!-- List all items for sale -->
      <!-- Repeated item cards start here -->
      <div class="showAllItems">
        <div class="itemCard" ng-repeat="item in ctrl.items">
          <div class="itemCardContainer">
            <div class="itemCardImageInfo">
              <div class="itemCardImage">
                <img ng-src={{item.image}}>
              </div>
              <div class="itemCardInfo">
                <ul>
                  <li>{{ item.name }}</li>
                  <li>{{ item.description }}</li>
                  <li>${{ item.cost }}</li>
                  <li>In Stock: {{ item.stockQuantity }}</li>
                </ul>
                <ul class="displayInline">
                  <li ng-if="ctrl.userIsAdmin"
                      ng-click="ctrl.indexOfEditForm = item._id"
                      ng-dblclick="ctrl.indexOfEditForm = null">
                      <a href="#">Edit</a>
                  </li>
                  <li ng-if="ctrl.userIsAdmin"
                      ng-click="ctrl.deleteItem(item)">
                      <a href="#">Delete</a>
                  </li>
                  <li ng-if="ctrl.loggedInUser"
                      ng-click="ctrl.addToCart(item)">
                      <a href="#">Add to Cart</a>
                  </li>
                </ul>
              </div>
            </div>
            <div  class="itemCardEditForm"
                  ng-if="ctrl.indexOfEditForm === item._id">
              <form ng-submit="ctrl.editItem(item)">
                <input  type="text"
                        ng-value="item.name"
                        ng-model="ctrl.updatedName"/>
                <input  type="text"
                        ng-value="item.description"
                        ng-model="ctrl.updatedDescription"/>
                <input  type="number"
                        ng-value="item.cost"
                        ng-model="ctrl.updatedCost"/>
                <input  type="text"
                        ng-value="item.image"
                        ng-model="ctrl.updatedImage"/>
                <input  type="number"
                        ng-value="ctrl.stockQuantity"
                        ng-model="ctrl.updatedStock"/><br>
                <input type="submit" value="edit item" />
              </form>
            </div>
          </div>
        </div>
      </div>
      <!-- Repeated item cards end here -->
    </main>
    <!-- ======================
    | | FOOTER
    ======================= -->
    <footer>
      <h6>Created By: Yulli & Becka, 2019</h6>
    </footer>
  </div>
  </body>
</html>
